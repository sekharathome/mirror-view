<!DOCTYPE html>
<html>
<head>
    <title>SystemSync Viewer</title>
    <style>
        body { background: #000; color: #fff; text-align: center; }
        canvas { width: 100%; max-width: 450px; border: 1px solid #444; margin-top: 20px; }
    </style>
</head>
<body>
    <h2>SystemSync Mirror</h2>
    <canvas id="canvas" width="720" height="1280"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const SERVER_URL = "wss://mirror-view.onrender.com"; // YOUR RENDER URL

        let decoder = new VideoDecoder({
            output: frame => { ctx.drawImage(frame, 0, 0); frame.close(); },
            error: e => console.error(e)
        });

        decoder.configure({ codec: 'avc1.42E01E', codedWidth: 720, codedHeight: 1280 });

        const ws = new WebSocket(SERVER_URL);
        ws.binaryType = 'arraybuffer';
        ws.onmessage = (e) => {
            const isKey = e.data.byteLength > 8000; // Keyframes are much larger
            try {
                decoder.decode(new EncodedVideoChunk({
                    type: isKey ? 'key' : 'delta',
                    timestamp: performance.now(),
                    data: e.data
                }));
            } catch(x) {}
        };
    </script>
</body>
</html>
